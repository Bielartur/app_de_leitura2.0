{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}

{# ---- TÍTULO DA ABA ---- #}
{% block title %}{% block page_title %}Fazer login{% endblock %}{% endblock %}

{% block class_body %} h-screen dark-body {% endblock %}
{% block body %}
    <header class="h-full w-full flex items-center justify-center">
        <div class="bg-white w-4/5 h-4/5 max-w-5xl flex shadow-xl rounded-sm">
            <div class="w-1/2 flex items-center justify-center gradient-container rounded-l-sm">
                <img src="{% block hero_image_src %}{% static 'img/livros_cafe.jpg' %}{% endblock %}"
                     alt="{% block hero_image_alt %}Livros e café{% endblock %}" class="img-login">
            </div>

            <div class="w-1/2 py-4 sm:p-4 px-6 flex flex-col justify-between">
                {# ---- BRAND HEADER ---- #}
                <div class="w-full flex flex-col justify-center">
                    <div class="w-full flex justify-between">
                        <h1 class="text-4xl font-semibold text-gradient">
                            {% block brand_title %}Habook{% endblock %}</h1>
                            {% if request.path != '/contas/login/' %}
                                <a href="{% url 'contas:login' %}"
                                   class="text-base bg-[var(--main-color)] text-white p-2 px-3 rounded-sm flex gap-2 items-center">
                                    <i class="fa-solid fa-arrow-left"></i><span>Voltar</span>
                                </a>
                            {% endif %}
                    </div>
                    <p>{% block brand_subtitle %}sua jornada de leitura, acompanhada de perto.{% endblock %}</p>
                </div>

                {# ---- FORM ---- #}
                <div class="mt-auto">
                    <form method="{% block form_method %}post{% endblock %}"
                          action="{% block form_action %}{% url 'login' %}{% endblock %}"
                          class="w-full flex flex-col justify-center gap-6">
                        {% csrf_token %}

                        <legend>
                            <span class="text-2xl text-gradient font-semibold">{% block legend_title %}
                                Login{% endblock %}</span>
                            <p class="text-sm font-semibold">{% block legend_subtitle %}Antes de iniciar sua jornada,
                                faça seu login{% endblock %}</p>
                        </legend>

                        {% block form_fields %}
                            {# Render genérico dos campos do 'form' passado no contexto #}
                            <div class="flex flex-col gap-3">
                                {% for campo in form %}
                                    {% if not campo.label == 'Lembrar de mim' %}
                                        <div class="w-full max-w-96 h-fit border-2 border-[var(--soft-blue)] rounded-md mx-auto mt-1 relative flex justify-end">
                                            {# Ícone estático à esquerda #}
                                            <div class="h-full w-8 absolute left-0 flex items-center justify-center">
                                                {% if campo.field.widget.input_type == 'email' or campo.label == 'Email' %}
                                                    <i class="fa-solid fa-envelope"></i>
                                                {% elif campo.field.widget.input_type == 'password' or campo.label == 'Senha' %}
                                                    <i class="fa-solid fa-lock"></i>
                                                {% elif campo.label == 'Nome' or campo.field.widget.input_type == 'text' %}
                                                    <i class="fa-solid fa-user"></i>
                                                {% else %}
                                                    <i class="fa-solid fa-pen"></i>
                                                {% endif %}
                                            </div>

                                            {# INPUT primeiro: precisa de peer + placeholder=" " #}
                                            {% render_field campo placeholder=" " class="peer p-2 ml-8 border-none bg-transparent outline-none rounded-sm input-form w-full" %}

                                            {# LABEL: flutuada por padrão; desce se placeholder estiver visível #}
                                            <label for="{{ campo.id_for_label }}"
                                                   class="pointer-events-none absolute left-2 -top-3 ml-4 px-1 bg-white
                                                    text-sm text-slate-600 transition-all duration-200
                                                    peer-[&:placeholder-shown:not(:focus)]:top-1/2
                                                    peer-[&:placeholder-shown:not(:focus)]:-translate-y-1/2
                                                    peer-[&:placeholder-shown:not(:focus)]:text-base
                                                    peer-[&:placeholder-shown:not(:focus)]:text-slate-500
                                                    peer-[&:placeholder-shown:not(:focus)]:translate-x-2
                                                        ">
                                                {{ campo.label }}
                                            </label>
                                        </div>
                                    {% else %}
                                        <div class="w-full max-w-96 mx-auto flex justify-between items-center">
                                          <span class="flex items-center gap-2">
                                            {{ campo }} <label for="{{ campo.id_for_label }}">{{ campo.label }}</label>
                                          </span>
                                            {% block alt_link %}
                                                <span class="text-sm">Não tem conta? <a
                                                        href="{% url 'contas:criar_conta' %}"
                                                        class="font-semibold hover:border-b-2">Crie aqui</a></span>
                                            {% endblock %}
                                        </div>
                                    {% endif %}

                                    {% for erro in campo.errors %}
                                        <p class="text-red-600 text-sm">{{ erro }}</p>
                                    {% endfor %}
                                {% endfor %}

                            </div>
                        {% endblock form_fields %}

                        <button type="submit" class="btn-action rounded-sm">
                            {% block submit_text %}Fazer Login{% endblock %}
                        </button>
                    </form>
                </div>

                {# ---- FOOTER COPY ---- #}
                <div class="w-full min-h-1/8 flex items-center my-auto">
                    <p>{% block footer_text %}
                        Você não está apenas lendo. Está construindo uma história de disciplina e conhecimento.
                    {% endblock %}</p>
                </div>
            </div>
        </div>
    </header>

    {% block extra_js %}{% endblock %}
{% endblock %}
